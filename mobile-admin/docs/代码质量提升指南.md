# ç§»åŠ¨ç®¡ç†ç«¯ä»£ç è´¨é‡æå‡æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0 | **åˆ›å»ºæ—¶é—´**: 2025-12-06

---

## ğŸ“‹ ç›®å½•

1. [Mockæ•°æ®ç®¡ç†](#mockæ•°æ®ç®¡ç†)
2. [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
3. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
4. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
5. [æµ‹è¯•è§„èŒƒ](#æµ‹è¯•è§„èŒƒ)

---

## ğŸ­ Mockæ•°æ®ç®¡ç†

### ä½¿ç”¨ MockManager ç»Ÿä¸€ç®¡ç†

MockManager æä¾›ç»Ÿä¸€çš„Mockæ•°æ®ç®¡ç†æ–¹æ¡ˆ,é¿å…Mockæ•°æ®åˆ†æ•£åœ¨å„ä¸ªæ–‡ä»¶ä¸­ã€‚

#### åŸºæœ¬ä½¿ç”¨

```javascript
import mockManager from '@/utils/mock-manager'

// æ³¨å†Œé™æ€Mockæ•°æ®
mockManager.registerData('user-list', [
  { id: 1, name: 'å¼ ä¸‰', role: 'admin' },
  { id: 2, name: 'æå››', role: 'staff' }
])

// æ³¨å†ŒåŠ¨æ€Mockå¤„ç†å™¨
mockManager.registerHandler('order-list', (params) => {
  const mockOrders = [
    { id: 1, orderNumber: 'ORD001', status: 'pending' },
    { id: 2, orderNumber: 'ORD002', status: 'completed' }
  ]

  // æ”¯æŒåˆ†é¡µ
  return mockManager.mockPagination(mockOrders, params)
})

// è·å–Mockæ•°æ®
const users = await mockManager.getData('user-list')
const orders = await mockManager.getData('order-list', { page: 1, pageSize: 20 })
```

#### é…ç½®Mockç®¡ç†å™¨

```javascript
// åœ¨ main.js ä¸­é…ç½®
import mockManager from '@/utils/mock-manager'

mockManager.setConfig({
  enabled: true,           // æ˜¯å¦å¯ç”¨Mock
  defaultDelay: 500,       // é»˜è®¤å»¶è¿Ÿæ—¶é—´(æ¯«ç§’)
  logging: true            // æ˜¯å¦æ‰“å°æ—¥å¿—
})
```

#### åœ¨APIæ–‡ä»¶ä¸­ä½¿ç”¨

**æ–¹å¼1: æ¡ä»¶åˆ¤æ–­**

```javascript
// api/order.js
import { get, post } from '@/utils/request'
import mockManager from '@/utils/mock-manager'

const USE_MOCK = true

export async function getOrderList(params) {
  if (USE_MOCK) {
    return mockManager.getData('order-list', params)
  }
  return get('/api/v1/orders', params)
}
```

**æ–¹å¼2: ä½¿ç”¨è£…é¥°å™¨(æ¨è)**

```javascript
// api/order.js
import { get } from '@/utils/request'
import { mockApi } from '@/utils/mock-manager'

export class OrderAPI {
  @mockApi('order-list')
  static async getOrderList(params) {
    return get('/api/v1/orders', params)
  }
}
```

#### Mockæ•°æ®å·¥å…·æ–¹æ³•

**åˆ†é¡µ**

```javascript
const mockOrders = [/* 100æ¡æ•°æ® */]

// è‡ªåŠ¨å¤„ç†åˆ†é¡µ
const result = mockManager.mockPagination(mockOrders, {
  page: 1,
  pageSize: 20
})

console.log(result)
// {
//   list: [...20æ¡æ•°æ®],
//   total: 100,
//   page: 1,
//   pageSize: 20,
//   hasMore: true
// }
```

**æœç´¢**

```javascript
const mockUsers = [
  { id: 1, name: 'å¼ ä¸‰', phone: '13800138000' },
  { id: 2, name: 'æå››', phone: '13800138001' }
]

// åœ¨nameå’Œphoneå­—æ®µä¸­æœç´¢
const result = mockManager.mockSearch(mockUsers, 'å¼ ä¸‰', ['name', 'phone'])
```

**ç­›é€‰**

```javascript
const mockOrders = [
  { id: 1, status: 'pending', type: 'daily' },
  { id: 2, status: 'completed', type: 'monthly' }
]

// ç­›é€‰æ¡ä»¶
const result = mockManager.mockFilter(mockOrders, {
  status: 'pending',
  type: 'daily'
})
```

**æ’åº**

```javascript
const mockOrders = [
  { id: 1, amount: 500, createTime: '2025-12-01' },
  { id: 2, amount: 300, createTime: '2025-12-02' }
]

// æŒ‰é‡‘é¢é™åºæ’åº
const result = mockManager.mockSort(mockOrders, 'amount', 'desc')
```

#### å®Œæ•´ç¤ºä¾‹

```javascript
// api/order.js
import { get, post } from '@/utils/request'
import mockManager from '@/utils/mock-manager'

const USE_MOCK = true

// æ³¨å†ŒMockæ•°æ®
if (USE_MOCK) {
  // ç”ŸæˆMockè®¢å•æ•°æ®
  const mockOrders = Array.from({ length: 100 }, (_, i) => ({
    id: i + 1,
    orderNumber: `ORD${String(i + 1).padStart(6, '0')}`,
    status: ['pending', 'confirmed', 'completed', 'cancelled'][i % 4],
    vehicleName: `æˆ¿è½¦${i + 1}å·`,
    amount: Math.floor(Math.random() * 5000) + 1000,
    createTime: mockManager.generateTimestamp(-i)
  }))

  // æ³¨å†Œå¤„ç†å™¨
  mockManager.registerHandler('order-list', (params) => {
    let result = mockOrders

    // æœç´¢
    if (params.keyword) {
      result = mockManager.mockSearch(result, params.keyword, ['orderNumber', 'vehicleName'])
    }

    // ç­›é€‰
    if (params.status) {
      result = mockManager.mockFilter(result, { status: params.status })
    }

    // æ’åº
    if (params.sortField) {
      result = mockManager.mockSort(result, params.sortField, params.sortOrder || 'desc')
    }

    // åˆ†é¡µ
    return mockManager.mockPagination(result, params)
  })
}

/**
 * è·å–è®¢å•åˆ—è¡¨
 */
export async function getOrderList(params) {
  if (USE_MOCK) {
    return mockManager.getData('order-list', params)
  }
  return get('/api/v1/orders', params)
}

/**
 * è·å–è®¢å•è¯¦æƒ…
 */
export async function getOrderDetail(id) {
  if (USE_MOCK) {
    return mockManager.mockResponse({
      id,
      orderNumber: `ORD${String(id).padStart(6, '0')}`,
      status: 'confirmed',
      vehicleName: 'æˆ¿è½¦1å·',
      amount: 3500,
      createTime: mockManager.generateTimestamp(-1)
    })
  }
  return get(`/api/v1/orders/${id}`)
}

export default {
  getOrderList,
  getOrderDetail
}
```

---

## ğŸ“ ä»£ç è§„èŒƒ

### å‘½åè§„èŒƒ

#### æ–‡ä»¶å‘½å

```bash
# âœ… æ¨è
components/common/SwipeAction.vue      # ç»„ä»¶ä½¿ç”¨ PascalCase
utils/mock-manager.js                  # å·¥å…·ä½¿ç”¨ kebab-case
api/order.js                           # APIæ–‡ä»¶ä½¿ç”¨ kebab-case
pages/orders/index.vue                 # é¡µé¢ä½¿ç”¨ kebab-case

# âŒ ä¸æ¨è
components/common/swipe-action.vue     # ç»„ä»¶ä¸è¦ç”¨ kebab-case
utils/MockManager.js                   # å·¥å…·ä¸è¦ç”¨ PascalCase
api/Order.js                           # APIæ–‡ä»¶ä¸è¦ç”¨ PascalCase
```

#### å˜é‡å‘½å

```javascript
// âœ… æ¨è
const userName = 'å¼ ä¸‰'                 // é©¼å³°å‘½å
const MAX_COUNT = 100                  // å¸¸é‡ä½¿ç”¨å¤§å†™
const isLoading = false                // å¸ƒå°”å€¼ä½¿ç”¨ is/has/can å‰ç¼€
const hasPermission = true
const canEdit = false

// âŒ ä¸æ¨è
const user_name = 'å¼ ä¸‰'                // ä¸è¦ç”¨ä¸‹åˆ’çº¿
const maxcount = 100                   // å¸¸é‡è¦å¤§å†™
const loading = false                  // å¸ƒå°”å€¼è¦æœ‰å‰ç¼€
```

#### å‡½æ•°å‘½å

```javascript
// âœ… æ¨è
function getUserList() {}              // è·å–æ•°æ®ç”¨ get
function createOrder() {}              // åˆ›å»ºç”¨ create
function updateOrder() {}              // æ›´æ–°ç”¨ update
function deleteOrder() {}              // åˆ é™¤ç”¨ delete
function handleClick() {}              // äº‹ä»¶å¤„ç†ç”¨ handle
function validateForm() {}             // éªŒè¯ç”¨ validate

// âŒ ä¸æ¨è
function userList() {}                 // ç¼ºå°‘åŠ¨è¯
function orderCreate() {}              // åŠ¨è¯åº”è¯¥åœ¨å‰
function clickHandler() {}             // åº”è¯¥æ˜¯ handleClick
```

### ä»£ç ç»„ç»‡

#### Vueç»„ä»¶ç»“æ„

```vue
<template>
  <!-- æ¨¡æ¿å†…å®¹ -->
</template>

<script>
// 1. å¯¼å…¥ä¾èµ–
import SomeComponent from '@/components/SomeComponent.vue'
import { someApi } from '@/api/some-api'
import { someUtil } from '@/utils/some-util'

// 2. ç»„ä»¶å®šä¹‰
export default {
  name: 'ComponentName',

  // 3. ç»„ä»¶æ³¨å†Œ
  components: {
    SomeComponent
  },

  // 4. Props
  props: {
    propName: {
      type: String,
      required: true,
      default: ''
    }
  },

  // 5. Data
  data() {
    return {
      loading: false,
      list: []
    }
  },

  // 6. Computed
  computed: {
    computedValue() {
      return this.list.length
    }
  },

  // 7. Watch
  watch: {
    list(newVal, oldVal) {
      console.log('list changed')
    }
  },

  // 8. ç”Ÿå‘½å‘¨æœŸé’©å­(æŒ‰é¡ºåº)
  beforeCreate() {},
  created() ,
  beforeMount() {},
  mounted() {},
  beforeUpdate() {},
  updated() {},
  beforeDestroy() {},
  destroyed() {},

  // 9. Methods
  methods: {
    async loadData() {
      // æ–¹æ³•å®ç°
    },

    handleClick() {
      // äº‹ä»¶å¤„ç†
    }
  }
}
</script>

<style scoped>
/* æ ·å¼ */
</style>
```

#### APIæ–‡ä»¶ç»“æ„

```javascript
/**
 * è®¢å•ç›¸å…³API
 */

import { get, post, put, del } from '@/utils/request'
import mockManager from '@/utils/mock-manager'

// æ˜¯å¦ä½¿ç”¨Mock
const USE_MOCK = true

// Mockæ•°æ®æ³¨å†Œ
if (USE_MOCK) {
  // æ³¨å†ŒMockæ•°æ®...
}

/**
 * è·å–è®¢å•åˆ—è¡¨
 * @param {Object} params - æŸ¥è¯¢å‚æ•°
 * @returns {Promise} è®¢å•åˆ—è¡¨
 */
export async function getOrderList(params) {
  if (USE_MOCK) {
    return mockManager.getData('order-list', params)
  }
  return get('/api/v1/orders', params)
}

/**
 * åˆ›å»ºè®¢å•
 * @param {Object} data - è®¢å•æ•°æ®
 * @returns {Promise} åˆ›å»ºç»“æœ
 */
export async function createOrder(data) {
  if (USE_MOCK) {
    return mockManager.mockResponse({ id: mockManager.generateId() })
  }
  return post('/api/v1/orders', data)
}

// é»˜è®¤å¯¼å‡º
export default {
  getOrderList,
  createOrder
}
```

### æ³¨é‡Šè§„èŒƒ

#### æ–‡ä»¶æ³¨é‡Š

```javascript
/**
 * è®¢å•ç®¡ç†ç›¸å…³API
 *
 * @module api/order
 * @author å¼ ä¸‰
 * @date 2025-12-06
 */
```

#### å‡½æ•°æ³¨é‡Š

```javascript
/**
 * è·å–è®¢å•åˆ—è¡¨
 *
 * @param {Object} params - æŸ¥è¯¢å‚æ•°
 * @param {number} params.page - é¡µç 
 * @param {number} params.pageSize - æ¯é¡µæ•°é‡
 * @param {string} params.status - è®¢å•çŠ¶æ€
 * @returns {Promise<Object>} è®¢å•åˆ—è¡¨æ•°æ®
 * @throws {Error} å½“è¯·æ±‚å¤±è´¥æ—¶æŠ›å‡ºé”™è¯¯
 *
 * @example
 * const result = await getOrderList({ page: 1, pageSize: 20 })
 * console.log(result.list)
 */
export async function getOrderList(params) {
  // å®ç°...
}
```

#### å¤æ‚é€»è¾‘æ³¨é‡Š

```javascript
// âœ… æ¨èï¼šè§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·åš
// ä½¿ç”¨é˜²æŠ–é¿å…é¢‘ç¹è¯·æ±‚,æå‡æ€§èƒ½
const debouncedSearch = debounce(this.search, 500)

// âœ… æ¨èï¼šè§£é‡Šå¤æ‚çš„ä¸šåŠ¡é€»è¾‘
// è®¢å•çŠ¶æ€ä¸º"å·²ç¡®è®¤"ä¸”è·ç¦»å¼€å§‹æ—¶é—´ä¸è¶³24å°æ—¶çš„è®¢å•ä¸å…è®¸å–æ¶ˆ
if (order.status === 'confirmed' &&
    (new Date(order.startTime) - new Date()) < 24 * 60 * 60 * 1000) {
  return false
}

// âŒ ä¸æ¨èï¼šæ³¨é‡Šæ˜¾è€Œæ˜“è§çš„ä»£ç 
// è®¾ç½®loadingä¸ºtrue
this.loading = true
```

---

## âš ï¸ é”™è¯¯å¤„ç†

### ç»Ÿä¸€é”™è¯¯å¤„ç†

#### APIé”™è¯¯å¤„ç†

```javascript
// utils/request.js
export async function request(url, options) {
  try {
    const response = await uni.request({
      url,
      ...options
    })

    // æ£€æŸ¥HTTPçŠ¶æ€ç 
    if (response.statusCode !== 200) {
      throw new Error(`HTTP ${response.statusCode}: ${response.statusText}`)
    }

    // æ£€æŸ¥ä¸šåŠ¡çŠ¶æ€ç 
    const { code, data, message } = response.data
    if (code !== 200) {
      throw new Error(message || 'è¯·æ±‚å¤±è´¥')
    }

    return data
  } catch (error) {
    // ç»Ÿä¸€é”™è¯¯å¤„ç†
    handleRequestError(error)
    throw error
  }
}

function handleRequestError(error) {
  let message = 'è¯·æ±‚å¤±è´¥'

  if (error.message) {
    message = error.message
  } else if (error.errMsg) {
    // uni-appé”™è¯¯
    if (error.errMsg.includes('timeout')) {
      message = 'è¯·æ±‚è¶…æ—¶'
    } else if (error.errMsg.includes('fail')) {
      message = 'ç½‘ç»œé”™è¯¯'
    }
  }

  uni.showToast({
    title: message,
    icon: 'none'
  })

  logger.error('Request', message, error)
}
```

#### ç»„ä»¶é”™è¯¯å¤„ç†

```javascript
export default {
  data() {
    return {
      loading: false,
      error: null
    }
  },

  methods: {
    async loadData() {
      this.loading = true
      this.error = null

      try {
        const result = await this.$api.getOrderList()
        this.list = result.list
      } catch (error) {
        this.error = error.message || 'åŠ è½½å¤±è´¥'

        uni.showToast({
          title: this.error,
          icon: 'none'
        })
      } finally {
        this.loading = false
      }
    }
  }
}
```

### è¾¹ç•Œæ¡ä»¶å¤„ç†

```javascript
// âœ… æ¨èï¼šæ£€æŸ¥å‚æ•°
function getItem(arr, index) {
  if (!Array.isArray(arr)) {
    throw new Error('arr must be an array')
  }

  if (index < 0 || index >= arr.length) {
    throw new Error('index out of bounds')
  }

  return arr[index]
}

// âœ… æ¨èï¼šä½¿ç”¨å¯é€‰é“¾å’Œç©ºå€¼åˆå¹¶
const userName = user?.profile?.name ?? 'æ¸¸å®¢'

// âœ… æ¨èï¼šæ•°ç»„æ“ä½œå‰æ£€æŸ¥
if (Array.isArray(list) && list.length > 0) {
  list.forEach(item => {
    // å¤„ç†...
  })
}

// âŒ ä¸æ¨èï¼šä¸æ£€æŸ¥å°±ä½¿ç”¨
const name = user.profile.name  // å¯èƒ½æŠ¥é”™
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### é¿å…ä¸å¿…è¦çš„æ¸²æŸ“

```vue
<template>
  <!-- âœ… ä½¿ç”¨ v-show åˆ‡æ¢æ˜¾ç¤º/éšè— -->
  <view v-show="visible">å†…å®¹</view>

  <!-- âœ… ä½¿ç”¨ v-if æ¡ä»¶æ¸²æŸ“ -->
  <view v-if="hasData">æœ‰æ•°æ®</view>
  <view v-else>æ— æ•°æ®</view>

  <!-- âœ… ä½¿ç”¨ key ä¼˜åŒ–åˆ—è¡¨æ¸²æŸ“ -->
  <view v-for="item in list" :key="item.id">
    {{ item.name }}
  </view>
</template>

<script>
export default {
  computed: {
    // âœ… ä½¿ç”¨è®¡ç®—å±æ€§ç¼“å­˜ç»“æœ
    filteredList() {
      return this.list.filter(item => item.status === 'active')
    }
  },

  methods: {
    // âŒ ä¸è¦åœ¨æ–¹æ³•ä¸­åšå¤æ‚è®¡ç®—
    getFilteredList() {
      return this.list.filter(item => item.status === 'active')
    }
  }
}
</script>
```

### ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµ

```javascript
import { debounce, throttle } from '@/utils/performance'

export default {
  methods: {
    // æœç´¢è¾“å…¥ - ä½¿ç”¨é˜²æŠ–
    handleSearch: debounce(function(keyword) {
      this.search(keyword)
    }, 500),

    // æ»šåŠ¨äº‹ä»¶ - ä½¿ç”¨èŠ‚æµ
    handleScroll: throttle(function(e) {
      console.log('æ»šåŠ¨ä½ç½®:', e.detail.scrollTop)
    }, 200)
  }
}
```

### å›¾ç‰‡ä¼˜åŒ–

```vue
<template>
  <!-- âœ… ä½¿ç”¨æ‡’åŠ è½½ -->
  <LazyImage
    :src="imageUrl"
    width="100%"
    height="400rpx"
  />

  <!-- âœ… æŒ‡å®šå›¾ç‰‡å°ºå¯¸ -->
  <image
    :src="imageUrl"
    mode="aspectFill"
    style="width: 750rpx; height: 400rpx;"
  />
</template>
```

---

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### å•å…ƒæµ‹è¯•

```javascript
// tests/unit/utils/mock-manager.spec.js
import mockManager from '@/utils/mock-manager'

describe('MockManager', () => {
  beforeEach(() => {
    mockManager.clear()
  })

  test('should register and get data', async () => {
    const mockData = { id: 1, name: 'test' }
    mockManager.registerData('test-data', mockData)

    const result = await mockManager.getData('test-data')
    expect(result).toEqual(mockData)
  })

  test('should handle pagination', () => {
    const list = Array.from({ length: 100 }, (_, i) => ({ id: i + 1 }))
    const result = mockManager.mockPagination(list, { page: 1, pageSize: 20 })

    expect(result.list).toHaveLength(20)
    expect(result.total).toBe(100)
    expect(result.hasMore).toBe(true)
  })
})
```

### ç»„ä»¶æµ‹è¯•

```javascript
// tests/unit/components/SwipeAction.spec.js
import { mount } from '@vue/test-utils'
import SwipeAction from '@/components/common/SwipeAction.vue'

describe('SwipeAction', () => {
  test('should render correctly', () => {
    const wrapper = mount(SwipeAction, {
      props: {
        actions: [
          { text: 'åˆ é™¤', type: 'danger' }
        ]
      },
      slots: {
        default: '<div>å†…å®¹</div>'
      }
    })

    expect(wrapper.text()).toContain('å†…å®¹')
  })

  test('should emit action-click event', async () => {
    const wrapper = mount(SwipeAction, {
      props: {
        actions: [
          { text: 'åˆ é™¤', type: 'danger' }
        ]
      }
    })

    await wrapper.find('.swipe-action-item').trigger('tap')
    expect(wrapper.emitted('action-click')).toBeTruthy()
  })
})
```

---

## ğŸ“Š ä»£ç è´¨é‡æ£€æŸ¥æ¸…å•

### æäº¤å‰æ£€æŸ¥

- [ ] ä»£ç ç¬¦åˆå‘½åè§„èŒƒ
- [ ] æ·»åŠ äº†å¿…è¦çš„æ³¨é‡Š
- [ ] å¤„ç†äº†æ‰€æœ‰é”™è¯¯æƒ…å†µ
- [ ] æ·»åŠ äº†è¾¹ç•Œæ¡ä»¶æ£€æŸ¥
- [ ] ä½¿ç”¨äº†æ€§èƒ½ä¼˜åŒ–æŠ€å·§
- [ ] ç¼–å†™äº†å•å…ƒæµ‹è¯•
- [ ] é€šè¿‡äº†ESLintæ£€æŸ¥
- [ ] é€šè¿‡äº†æ‰€æœ‰æµ‹è¯•

### Code Reviewæ£€æŸ¥

- [ ] ä»£ç é€»è¾‘æ¸…æ™°æ˜“æ‡‚
- [ ] æ²¡æœ‰é‡å¤ä»£ç 
- [ ] å‡½æ•°èŒè´£å•ä¸€
- [ ] å˜é‡å‘½åæœ‰æ„ä¹‰
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ€§èƒ½è€ƒè™‘å……åˆ†
- [ ] æµ‹è¯•è¦†ç›–å®Œæ•´

---

## ğŸ”§ å·¥å…·æ¨è

### ESLinté…ç½®

```javascript
// .eslintrc.js
module.exports = {
  extends: [
    'plugin:vue/essential',
    'eslint:recommended'
  ],
  rules: {
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'vue/multi-word-component-names': 'off',
    'no-unused-vars': 'warn',
    'no-undef': 'error'
  }
}
```

### Prettieré…ç½®

```javascript
// .prettierrc.js
module.exports = {
  semi: false,
  singleQuote: true,
  trailingComma: 'none',
  printWidth: 100,
  tabWidth: 2
}
```

---

**æ–‡æ¡£ç»´æŠ¤**: å¨å¨æˆ¿è½¦æŠ€æœ¯å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2025-12-06
**ç‰ˆæœ¬**: v1.0.0
