# 小程序端与后端API完整联调测试指南

**更新时间**: 2025-12-26 10:50
**状态**: ✅ 就绪

---

## 📋 测试准备

### 1. 环境要求

**后端环境**:
- Node.js 18.18.0+
- MySQL 8.0.35
- Redis 7.2.3
- 端口 3001 可用

**小程序环境**:
- HBuilderX
- 微信开发者工具
- 网络连接正常

### 2. 启动服务

**启动后端**:
```bash
cd backend
npm run dev
```

验证: 访问 http://localhost:3001 应返回服务信息

**启动小程序**:
1. 使用HBuilderX打开 `miniprogram` 目录
2. 点击"运行" → "运行到微信开发者工具"
3. 在微信开发者工具中勾选"不校验合法域名"

---

## ✅ 核心模块测试 (15个接口)

### 1. 认证模块测试

#### 1.1 发送验证码
```
测试步骤:
1. 打开小程序登录页
2. 输入手机号: 13800138000
3. 点击"获取验证码"

预期结果:
- 显示"验证码发送成功"
- 按钮变为倒计时状态
```

#### 1.2 验证码登录
```
测试步骤:
1. 输入验证码: 123456
2. 点击"登录"

预期结果:
- 登录成功
- 跳转到首页
- Token已保存
```

#### 1.3 获取用户信息
```
测试步骤:
1. 登录后进入"我的"页面

预期结果:
- 显示用户昵称
- 显示用户头像
- 显示用户手机号
```

### 2. 门店模块测试

#### 2.1 获取城市列表
```
测试步骤:
1. 进入"门店"页面
2. 点击城市选择

预期结果:
- 显示城市列表
- 包含门店数量
```

#### 2.2 获取门店列表
```
测试步骤:
1. 选择城市
2. 查看门店列表

预期结果:
- 显示门店列表
- 包含门店名称、地址、电话
- 支持分页加载
```

### 3. 车辆模块测试

#### 3.1 获取车辆列表
```
测试步骤:
1. 进入"车辆"页面
2. 选择门店

预期结果:
- 显示车辆列表
- 包含车辆图片、名称、价格
- 支持分页加载
```

#### 3.2 获取车辆详情
```
测试步骤:
1. 点击车辆卡片

预期结果:
- 显示车辆详细信息
- 包含规格参数
- 包含特色功能
```

### 4. 订单模块测试

#### 4.1 创建订单
```
测试步骤:
1. 选择车辆
2. 选择取还车门店和时间
3. 填写联系信息
4. 点击"提交订单"

预期结果:
- 订单创建成功
- 返回订单号
- 跳转到支付页面
```

#### 4.2 获取订单列表
```
测试步骤:
1. 进入"订单"页面
2. 查看订单列表

预期结果:
- 显示订单列表
- 包含订单状态
- 支持筛选和分页
```

#### 4.3 获取订单详情
```
测试步骤:
1. 点击订单卡片

预期结果:
- 显示订单详细信息
- 包含车辆信息
- 包含门店信息
- 包含价格明细
```

### 5. 支付模块测试

#### 5.1 创建支付
```
测试步骤:
1. 在订单详情页点击"支付"
2. 选择支付方式

预期结果:
- 调起支付界面
- 返回支付参数
```

---

## 🚀 P3模块测试 (80个接口)

### 1. 会员服务模块 (7个接口)

#### 测试场景
```
1. 获取会员信息
   - 进入"会员中心"
   - 查看会员等级和权益

2. 查看会员套餐
   - 点击"开通会员"
   - 查看套餐列表

3. 购买会员
   - 选择套餐
   - 完成支付

4. 管理自动续费
   - 开启/关闭自动续费
```

### 2. 评价反馈模块 (6个接口)

#### 测试场景
```
1. 创建评价
   - 订单完成后
   - 填写评价内容
   - 上传图片

2. 查看我的评价
   - 进入"我的评价"
   - 查看评价列表

3. 编辑评价
   - 点击评价
   - 修改内容
```

### 3. 帮助中心模块 (6个接口)

#### 测试场景
```
1. 浏览帮助分类
   - 进入"帮助中心"
   - 查看分类列表

2. 搜索文章
   - 输入关键词
   - 查看搜索结果

3. 查看文章详情
   - 点击文章
   - 查看详细内容
```

### 4. 钱包模块 (3个接口)

#### 测试场景
```
1. 查看余额
   - 进入"我的钱包"
   - 查看余额和明细

2. 查看交易记录
   - 查看收支记录
   - 支持分页

3. 申请提现
   - 填写提现信息
   - 提交申请
```

---

## 📊 测试检查清单

### 功能测试

- [ ] 用户注册登录
- [ ] 验证码发送
- [ ] Token管理
- [ ] 用户信息获取
- [ ] 门店列表查询
- [ ] 车辆列表查询
- [ ] 订单创建
- [ ] 订单查询
- [ ] 支付创建
- [ ] 会员服务
- [ ] 评价反馈
- [ ] 帮助中心
- [ ] 钱包功能

### 数据格式测试

- [ ] 响应格式统一
- [ ] 分页格式正确
- [ ] 日期格式统一
- [ ] 错误处理正确

### 异常测试

- [ ] Token过期处理
- [ ] 网络错误处理
- [ ] 参数错误处理
- [ ] 权限错误处理

---

## 🐛 常见问题

### 1. 连接失败

**问题**: 小程序无法连接后端

**解决方案**:
1. 检查后端服务是否启动
2. 检查端口3001是否被占用
3. 检查微信开发者工具是否勾选"不校验合法域名"

### 2. Token失效

**问题**: 请求返回401未授权

**解决方案**:
1. 重新登录获取新Token
2. 检查Token是否正确保存
3. 检查请求头是否正确添加Authorization

### 3. 数据格式错误

**问题**: 响应数据格式不符合预期

**解决方案**:
1. 检查后端响应格式
2. 检查小程序端数据解析
3. 查看控制台错误日志

---

**文档版本**: v1.0
**生成时间**: 2025-12-26 10:50
